# 小包搜题题库规范化工具

## 项目描述
本项目用于将非标准化的Excel题库文件转换为符合指定格式的规范化文件，符合题库制作助手规范。主要功能包括：
- 自动转换`.xls`为`.xlsx`格式
- 清洗选项和答案数据
- 动态生成标准列结构（考题、答案、选项A、选项B...）
- 统计标题、选项及答案的字符分布

## 依赖安装
```bash
pip install pandas xlrd openpyxl xlsxwriter
# or
pip install -r requirements.txt
```

## 使用步骤

1. 运行主程序
```bash
python main.py
```

2. 输入路径

- 输入待处理的文件夹路径（包含原始Excel文件）

- 确认生成题库时输入输出文件夹路径

3. 处理流程

- 自动扫描并统计标题格式

- 显示选项/答案字符分布统计

- 用户确认后执行格式转换

## 文件说明

| 文件名 |	功能描述 |
| --------- | --------- |
| format.py	| 核心处理逻辑：文件转换、数据清洗、格式规范化 |
| parse.py	| 解析统计功能：标题识别、字符频率分析 |
| main.py	| 主入口程序：用户交互、流程控制 |

## 输入文件要求
- 必须包含以下列（名称需完全匹配）：

    - 题目名称 → 自动重命名为考题

    - 答案

    - 选项（多个选项用|分隔）

- 标题行必须包含序号字段

## 输出格式规范
```csv
考题 | 答案 | 选项A | 选项B | 选项C | 选项D | ...
```

## 功能特性
- ✅ 自动转换老旧.xls格式

- ✅ 智能清洗选项前缀符号（如A. B-）

- ✅ 空值数据自动过滤

- 📊 提供格式分析报告

- ⚠️ 异常文件自动跳过并提示

## 注意事项

- ***数据备份***：输出文件夹会被清空，请勿指向重要目录

- 编码要求：文件需使用UTF-8编码

- 特殊符号：避免在选项中使用未定义的|符号

- 答案格式：仅保留首字母（如A/B），忽略后续字符

## 开发扩展

- 支持自定义列映射（修改format.py中的rename逻辑）

- 扩展清洗规则（修改clean_option函数）

- 增加输出格式支持（如CSV）

## 示例输出
```
请输入要扫描的文件夹路径：xxx
已将 xxx.xls 转换为 xxx.xlsx
列名: 序号, 题目名称, 题目类型, 选项, 答案, 出现次数: 2
选项后字符 . 出现了 1 次
答案第二个字符 B 出现了 1 次
答案第二个字符 C 出现了 1 次
是否确认生成题库(y/n)：y
请输入要保存的文件夹路径：./output
总共处理了 1 个文件
成功复制了 1 个 .xlsx 文件
成功转换了 1 个 .xls 文件
已删除文件: xxx.xls
已处理并保存文件: xxx.xlsx
总共遍历了 1 个文件，处理并保存了 1 个文件
```

📌 提示：首次运行建议先用测试文件夹验证格式兼容性

⚙️ 技术支持：遇到异常时查看控制台输出的错误信息定位问题


